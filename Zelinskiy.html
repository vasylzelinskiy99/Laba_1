<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Offline Web Applications - Dive Into HTML5</title>
    <link href="https://fonts.googleapis.com/css?family=Gloria+Hallelujah|Lora" rel="stylesheet">
</head>

<body style="font-family: 'Lora', serif;">
    <div style="max-width: 960px;margin: 0 auto;">
        <nav style="">
            <p>You are here: <a href="index.html" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Home</a>
                <span> > </span>
                <a href="#" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Dive Into <abbr>HTML5</abbr></a>
            </p>
        </nav>

        <div style="text-align: center">
            <h1 style="font-family: 'Gloria Hallelujah', cursive;margin: 1em auto; font-size: 4em; text-transform: uppercase">№8.<br>Let’s Take This Offline</h1>
            <a href="#" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">show table of contents</a>
        </div>

        <h2 style="font-family: 'Gloria Hallelujah', cursive; margin: 1em;font-size: 2.5em;text-transform: uppercase;text-align:center">Diving In</h2>

        <p style="font-size: large;margin: 1.5em 0;">What is an offline web application? At first glance, it sounds like a contradiction in terms. Web pages are things you download and render. Downloading implies a network connection. How can you download when you’re offline? Of course, you can’t. But you can download when you’re online. And that’s how HTML5 offline applications work.</p>
        <p style="font-size: large;margin: 1.5em 0;">At its simplest, an offline web application is a list of URLs — HTML, CSS, JavaScript, images, or any other kind of resource. The home page of the offline web application points to this list, called a manifest file, which is just a text file located elsewhere on the web server. A web browser that implements HTML5 offline applications will read the list of URLs from the manifest file, download the resources, cache them locally, and automatically keep the local copies up to date as they change. When the time comes that you try to access the web application without a network connection, your web browser will automatically switch over to the local copies instead.</p>
        <p style="font-size: large;margin: 1.5em 0;">From there, most of the work is up to you, the web developer. There’s a flag in the DOM that will tell you whether you’re online or offline. There are events that fire when your offline status changes (one minute you’re offline and the next minute you’re online, or vice-versa). But that’s pretty much it. If your application creates data or saves state, it’s up to you to store that data locally while you’re offline and synchronize it with the remote server once you’re back online. In other words, HTML5 can take your web application offline. What you do once you’re there is up to you.</p>
        <table style="width: 100%;border-collapse: collapse; text-transform: uppercase">
            <caption style="font-weight: normal;text-transform: uppercase;text-shadow: 0 0 1px #667; font-size:1.2em ">Offline Support</caption>
            <thead>
                <tr>
                    <th>IE</th>
                    <th>Firefox</th>
                    <th>Safari</th>
                    <th>Chrome</th>
                    <th>Opera</th>
                    <th>iPhone</th>
                    <th>Android
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr style="text-align: center">
                    <td>·</td>
                    <td>3.5+</td>
                    <td>4.0+</td>
                    <td>5.0+</td>
                    <td>10.6+</td>
                    <td>2.1+</td>
                    <td>2.0+
                    </td>
                </tr>
            </tbody>
        </table>

        <h2 style="text-transform: uppercase;text-align:center; font-family: 'Gloria Hallelujah', cursive; margin: 1em;font-size: 2.5em;text-shadow: 0 0 1px #667;">The Cache Manifest</h2>


        <p style="font-size: large;margin: 1.5em 0;">
            An offline web application revolves around a cache manifest file. What’s a manifest file? It’s a list of all of the resources that your web application might need to access while it’s disconnected from the network. In order to bootstrap the process of downloading and caching these resources, you need to point to the manifest file, using a manifest attribute on your
            <html> element.
        </p>
        <code style="padding-left: 2em">&lt;!DOCTYPE html&gt;
            &lt;html <mark>manifest="/cache.manifest"</mark>&gt;<br>
            &lt;body&gt;<br>
            ...<br>
            &lt;/body&gt;<br>
            &lt;/html&gt;</code><br>

        <p style="font-size: large;margin: 1.5em 0;">Your cache manifest file can be located anywhere on your web server, but it must be served with the content type text/cache-manifest. If you are running an Apache-based web server, you can probably just put an AddType directive in the .htaccess file at the root of your web directory:</p>

        <code style="padding-left: 2em">AddType text/cache-manifest .manifest</code>
        <p style="font-size: large;margin: 1.5em 0;">Then make sure that the name of your cache manifest file ends with .manifest. If you use a different web server or a different configuration of Apache, consult your server’s documentation on controlling the Content-Type header.</p>

        <div style="border: 1px solid;">
            <h4 style="margin: 0;padding: 4px;background: black;color: white;">ASK PROFESSOR MARKUP</h4>
            <div style="min-height: 245px;margin: 0 15px 0 0;padding:1em 3em;padding-right: 190px; background: white url(http://diveintohtml5.info/i/openclipart.org_johnny_automatic_little_professor.png) bottom right no-repeat;">
                <p style="font-size: large;margin: 1.5em 0;">Q: My web application spans more than one page. Do I need a manifest attribute in each page, or can I just put it in the home page?
                </p>
                <p style="font-size: large;margin: 1.5em 0;">A: Every page of your web application needs a manifest attribute that points to the cache manifest for the entire application.
                </p>
            </div>
        </div>

        <p style="font-size: large;margin: 1.5em 0;">OK, so every one of your HTML pages points to your cache manifest file, and your cache manifest file is being served with the proper Content-Type header. But what goes in the manifest file? This is where things get interesting.</p>


        <p style="font-size: large;margin: 1.5em 0;">The first line of every cache manifest file is this:</p>
        <p style="font-size: large;margin: 1.5em 0;">CACHE MANIFEST</p>
        <p style="font-size: large;margin: 1.5em 0;">After that, all manifest files are divided into three parts: the “explicit” section, the “fallback” section, and the “online whitelist” section. Each section has a header, on its own line. If the manifest file doesn’t have any section headers, all the listed resources are implicitly in the “explicit” section. Try not to dwell on the terminology, lest your head explode.</p>

        <p style="font-size: large;margin: 1.5em 0;">Here is a valid manifest file. It lists three resources: a CSS file, a JavaScript file, and a JPEG image.</p>
        <code style="padding-left: 2em">CACHE MANIFEST
            /clock.css
            /clock.js
            /clock-face.jpg
        </code>
         <p style="font-size: large;margin: 1.5em 0;">This cache manifest file has no section headers, so all the listed resources are in the “explicit” section by default. Resources in the “explicit” section will get downloaded and cached locally, and will be used in place of their online counterparts whenever you are disconnected from the network. Thus, upon loading this cache manifest file, your browser would download clock.css, clock.js, and clock-face.jpg from the root directory of your web server. Then you could unplug your network cable and refresh the page, and all of those resources would be available offline.</p>
         <div style="border: 1px solid;">
            <h4 style="margin: 0;padding: 4px;background: black;color: white;">ASK PROFESSOR MARKUP</h4>
            <div style="min-height: 245px;margin: 0 15px 0 0;padding:1em 3em;padding-right: 190px; background: white url(http://diveintohtml5.info/i/openclipart.org_johnny_automatic_little_professor.png) bottom right no-repeat;">
                <p style="font-size: large;margin: 1.5em 0;">Q: Do I need to list my HTML pages in my cache manifest?
                </p>
                <p style="font-size: large;margin: 1.5em 0;">A: Yes and no. If your entire web application is contained in a single page, just make sure that page points to the cache manifest using the manifest attribute. When you navigate to an HTML page with a manifest attribute, the page itself is assumed to be part of the web application, so you don’t need to list it in the manifest file itself. However, if your web application spans multiple pages, you should list all of the HTML pages in the manifest file, otherwise the browser would not know that there are other HTML pages that need to be downloaded and cached.
                </p>
            </div>
        </div>
         
        <h2 style="font-family: 'Gloria Hallelujah', cursive; margin: 1em;font-size: 2.5em;text-transform:uppercase;text-align:center;text-shadow: 0 0 1px #667;">NETWORK SECTIONS</h2>

        <p style="font-size: large;margin: 1.5em 0;">Here is a slightly more complicated example. Suppose you want your clock application to track visitors, using a tracking.cgi script that is loaded dynamically from an <img src> attribute. Caching this resource would defeat the purpose of tracking, so this resource should never be cached and never be available offline. Here is how you do that:</p>
    
        <code style="padding-left: 2em">CACHE MANIFEST
        NETWORK:
        /tracking.cgi
        CACHE:
        /clock.css
        /clock.js
            /clock-face.jpg</code>

        <p style="font-size: large;margin: 1.5em 0;">This cache manifest file includes section headers. The line marked NETWORK: is the beginning of the “online whitelist” section. Resources in this section are never cached and are not available offline. (Attempting to load them while offline will result in an error.) The line marked CACHE: is the beginning of the “explicit” section. The rest of the cache manifest file is the same as the previous example. Each of the three resources listed will be cached and available offline.</p>


        <h2 style="font-family: 'Gloria Hallelujah', cursive; margin: 1em;font-size: 2.5em;text-transform:uppercase;text-align:center;text-shadow: 0 0 1px #667;">FALLBACK SECTIONS</h2>

       
       
       

        <h2 style="text-transform: uppercase;text-align:center; font-family: 'Gloria Hallelujah', cursive; margin: 1em;font-size: 2.5em;">Further reading</h2>

        <ul style="font-size: large;margin: 1.5em 0;">
            <li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Session history and navigation</a> in the <abbr>HTML5</abbr> draft standard
            </li>
            <li><a href="https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Manipulating the browser history</a> on Mozilla Developer Center
            </li>
            <li><a href="http://html5demos.com/history" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Simple history <abbr>API</abbr> demo</a>
            </li>
            <li><a href="http://www.20thingsilearned.com/" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">20 Things I Learned About Browsers and the Web</a>, an advanced demo that uses the history <abbr>API</abbr> and other <abbr>HTML5</abbr> techniques
            </li>
            <li><a href="http://www.facebook.com/note.php?note_id=438532093919" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Using <abbr>HTML5</abbr> today</a> describes <a href="http://www.facebook.com/" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Facebook’s</a> use of the history <abbr>API</abbr>
            </li>
            <li><a href="https://github.com/blog/760-the-tree-slider" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">The Tree Slider</a> describes <a href="https://github.com/" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Github’s</a> use of the history <abbr>API</abbr>
            </li>
            <li><a href="https://github.com/balupton/History.js/" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">History.js</a>, a meta-<abbr>API</abbr> for manipulating history in both newer and older browsers
            </li>
        </ul>

        <p style="font-size: medium;line-height: 1.75;margin: 1.75em 0; text-align: center;">Copyright MMIX–MMXI <a href="#" style="color: FireBrick;border-bottom: 1px dotted;text-decoration: none">Mark Pilgrim</a></p>
    </div>
</body>

</html>
